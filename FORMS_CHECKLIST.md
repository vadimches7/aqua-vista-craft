# –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–æ—Ä–º

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **–í—Å–µ —Ñ–æ—Ä–º—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–∞–Ω–Ω—ã–µ –≤ Albato Webhook**
   - Calculator.tsx ‚úÖ
   - InstallationTariffsSection.tsx ‚úÖ

2. **Popup –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏**
   - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Üí popup ‚úÖ
   - –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí WhatsApp (—Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç) ‚úÖ

3. **–î–∞–Ω–Ω—ã–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –≤–∫–ª—é—á–µ–Ω—ã –≤ payload**
   - project_type ‚úÖ
   - volume ‚úÖ
   - calculated_price ‚úÖ
   - address ‚úÖ

4. **–î–∞–Ω–Ω—ã–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –≤–∫–ª—é—á–µ–Ω—ã –≤ payload**
   - tariff_title ‚úÖ
   - tariff_price ‚úÖ

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)

### 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ä–º—É "–£—Ç–æ—á–Ω–∏—Ç—å –ø–æ–¥ –º–æ—ë –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ"

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
1. –í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
   ```
   [Albato] Sending request to webhook: ...
   [Albato] Sending form data: ...
   [Albato] Response status: 200 ...
   [Albato] Success! Response: OK
   [Tariff] Form submitted successfully, showing popup
   [PostSubmitBus] Opening popup { source: 'tariffs' }
   [PostSubmitPopup] Showing popup (first time in session) ...
   [PostSubmitPopup] Rendering popup ...
   ```

2. –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–æ—Ä–º—ã –¥–æ–ª–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å—Å—è
3. –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è popup —Å –≤–∏–¥–µ–æ –∏ CTA-–∫–Ω–æ–ø–∫–∞–º–∏
4. WhatsApp –ù–ï –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è

### 3. –ï—Å–ª–∏ popup –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å `[PostSubmitBus] Opening popup`? 
  - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –≤—ã–∑–æ–≤–µ `openPopup()`
  - –ï—Å–ª–∏ –¥–∞ ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ `usePostSubmitPopup` –∏–ª–∏ `PostSubmitPopup`

- –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å `[PostSubmitPopup] Showing popup`?
  - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí popup —É–∂–µ –±—ã–ª –ø–æ–∫–∞–∑–∞–Ω –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏
  - –†–µ—à–µ–Ω–∏–µ: –æ—á–∏—Å—Ç–∏—Ç–µ `sessionStorage.removeItem('bc_popup_shown')` –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `NEXT_PUBLIC_SHOW_POPUP_ALWAYS='true'`

- –í –∫–æ–Ω—Å–æ–ª–∏ –µ—Å—Ç—å `[PostSubmitPopup] Rendering popup`?
  - –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `PostSubmitPopup`

### 4. –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è WhatsApp –≤–º–µ—Å—Ç–æ popup

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Albato (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏)
2. `sendToAlbato` –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É (–¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —É—Å–ø–µ—à–µ–Ω)
3. Popup –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑-–∑–∞ sessionStorage

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤ Albato –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å 200
- –û—á–∏—Å—Ç–∏—Ç–µ sessionStorage: `sessionStorage.removeItem('bc_popup_shown')`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ popup (–¥–∞–∂–µ –µ—Å–ª–∏ —É–∂–µ –±—ã–ª –ø–æ–∫–∞–∑–∞–Ω):

–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```javascript
sessionStorage.removeItem('bc_popup_shown');
```

–ò–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```
NEXT_PUBLIC_SHOW_POPUP_ALWAYS=true
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Network tab (F12 ‚Üí Network)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ä–º—É
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∫ `h.albato.ru`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Request Payload - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—Å–µ –ø–æ–ª—è:
   - name
   - phone
   - source: "bio-cube.ru"
   - page_url
   - form: "tariff" –∏–ª–∏ "calculator"
   - tariff_title, tariff_price (–¥–ª—è —Ç–∞—Ä–∏—Ñ–æ–≤)
   - project_type, volume, calculated_price, address (–¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞)

## üìù –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

–í—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
- `[Albato]` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ webhook
- `[Calculator]` / `[Tariff]` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã
- `[PostSubmitBus]` - –≤—ã–∑–æ–≤ popup
- `[PostSubmitPopup]` - –ø–æ–∫–∞–∑ popup

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏.

